<ng-include src="'/static/partials/pageHeaderWidget.html'"></ng-include>

<div class="container" id="galaxy-role-detail">

    <div class="row" ng-show="my_info.staff" style="margin-bottom: 15px;">
        <div class="col-xs-offset-6 col-xs-6 text-right">
            <a class="btn btn-danger btn-sm" href ng-click="staffDeleteRole(role)"><i class="fa fa-trash-o"></i> Delete Role</a>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-6" ng-if="role.name">
            <h2 class="rolename">{{role.name}}</h2>
            <div class="description">{{role.description}}</div>
        </div>
        <div class="col-xs-6" ng-if="!role.name">
            <h2 class="rolename">Requested Role Not Found</h2>
        </div>
        <div class="col-xs-6 text-right">
            <div class="user-info" ng-show="avatar">
                <img ng-src="{{ avatar }}" />
                <p class="username" ng-if="role.username"><a href="https://github.com/{{ role.username }}" target="_blank">{{ role.username }}</a></p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="documentation">
                <uib-tabset type="pills">
                    <uib-tab heading="Details">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="badge-container">
                                    <a ng-href="{{ role.travis_build_url }}" target="_blank">
                                    <img ng-src="{{ role.travis_status_url }}" class="travis-status-img" tooltip-placement="top" uib-tooltip="Travis Build Status" ng-if="role.travis_status_url" />
                                    </a>
                                    <div class="download-badge" tooltip-placement="top" uib-tooltip="Galaxy Download Count">
                                        <div class="title">Downloads</div>
                                        <div class="count">{{ role.download_count }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row button-row">
                            <div class="col-sm-8">
                                <a class="btn btn-default btn-md" ng-href="{{ role.issue_tracker_url }}"
                                   ng-show="role.issue_tracker_url" target="_blank"><i class="fa fa-bug"></i> Issue Tracker</a>
                                
                                <a class="btn btn-default btn-md" ng-href="https://github.com/{{role.github_user}}/{{role.github_repo}}" target="_blank"><i class="fa fa-github"></i> Github Repo</a>
                                
                                <a href="" ng-if="!role.user_is_subscriber" ng-click="subscribe(role)"
                                    class="btn btn-default btn-md" ng-disabled="!is_authenticated">
                                    <i class="fa fa-eye" ng-show="!role.subscribing"></i><i class="fa fa-spinner fa-spin" ng-show="role.subscribing"></i> Watch &nbsp;{{ role.watchers_count }}
                                </a>
                                <a href="" ng-if="role.user_is_subscriber" ng-click="unsubscribe(role)"
                                    class="btn btn-default btn-md" ng-disabled="!is_authenticated">
                                    <i class="fa fa-eye" ng-show="!role.subscribing"></i><i class="fa fa-spinner fa-spin" ng-show="role.subscribing"></i> Unwatch &nbsp;{{ role.watchers_count }}
                                </a>

                                <a href="" ng-if="!role.user_is_stargazer" ng-click="star(role)"
                                        class="btn btn-default btn-md" ng-disabled="!is_authenticated">
                                        <i class="fa fa-star" ng-show="!role.starring"></i><i class="fa fa-spinner fa-spin" ng-show="role.starring"></i> Star {{ role.stargazers_count }}
                                </a>
                                <a href="" ng-if="role.user_is_stargazer" ng-click="unstar(role)"
                                    class="btn btn-default btn-md" ng-disabled="!is_authenticated">
                                    <i class="fa fa-star" ng-show="!role.starring"></i><i class="fa fa-spinner fa-spin" ng-show="role.starring"></i> Unstar {{ role.stargazers_count }}
                                </a>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12">
                                <table class="details">
                                    <tr>
                                        <td class="key">Minimum Ansible Version</td><td class="value">{{ role.min_ansible_version }}</td>
                                    </tr>
                                    <tr>
                                        <td class="key">Installation</td><td class="value"><code>$ ansible-galaxy install {{role.username}}.{{role.name}}</code></td>
                                    </tr>
                                    <tr>
                                        <td class="key">Tags</td><td class="value"><div ng-repeat="tag in role.tags" class="galaxy-tag">{{ tag }}</div></td>
                                    </tr>
                                    <tr>
                                        <td class="key">Created</td><td class="value">{{ role.created | date:"short" }}</td>
                                    </tr>
                                    <tr>
                                        <td class="key">Last Commit</td>
                                        <td class="value" ng-if="role.last_commit_date">{{ role.last_commit_date | date:"short" }}</td>
                                        <td class="value na" ng-if="!role.last_commit_date">NA</td>
                                    </tr>
                                    <tr>
                                        <td class="key">Last Import</td>
                                        <td class="value" ng-if="role.imported">{{ role.imported | date:"short" }}</td>
                                        <td class="value na" ng-if="!role.imported">NA</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="versions section">
                                    <table class="table ga-table-striped">
                                        <caption>Version History</caption>
                                        <thead>
                                            <tr>
                                                <th>Version</th>
                                                <th>Release Date</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="version in role.versions">
                                                <td>{{ version.name }}</td>
                                                <td>{{ version.release_date | date:"short" }}</td>
                                            </tr>
                                            <tr ng-show="!role.versions.length">
                                                <td colspan="2">No version history available.</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="platforms section">
                                    <table class="table ga-table-striped">
                                        <caption>Supported Platforms</caption>
                                        <thead>
                                            <tr>
                                                <th>Platform</th>
                                                <th>Version</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller section">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="platform in role.platform_details">
                                                <td>{{ platform.name }}</td>
                                                <td>{{ platform.release }}</td>
                                            </tr>
                                            <tr ng-show="!role.platform_details.length">
                                                <td colspan="2">No platform information available.</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="dependencies section">
                                    <table class="table ga-table-striped">
                                        <caption>Dependencies</caption>
                                        <thead>
                                            <tr>
                                                <th>Role</th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <div class="table-scroller">
                                        <table class="table ga-table-striped">
                                            <tbody>
                                            <tr ng-repeat="dependency in role.dependencies">
                                                <td><a href="/detail#/role/{{ dependency.id }}">{{ dependency.name }}</a></td>
                                            </tr>
                                            <tr ng-show="!role.dependencies.length">
                                                <td colspan="2">No dependencies.</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div> 
                        </div>

                    </uib-tab>

                    <uib-tab heading="README" select="loadReadMe()">
                        <div ng-bind-html="readMe" id="readme"></div>
                        <ng-include src="'/static/partials/loader.html'"></ng-include>
                    </uib-tab>
                </uib-tabset>
            </div>
        </div>
    </div>
</div> <!-- end container -->
