{% extends 'base.html' %}

{% load galaxyhelpers %}

{% block general_content %}

<div id="galaxy-page-title">
    <div class="container">
        <div class="page-title">
            {{ request.path | urlname }}
        </div>
    </div>
</div>

<div class="container" id="galaxy-intro-page">
    <div class="row">
        <div class="col-lg-4 col-md-4">
            <nav class="galaxy-intro-links hidden-sm hidden-xs" data-spy="affix" data-offset-top="160">
                <div class="galaxy-nav-title">
                    <i class="fa fa-bars"></i> MENU
                </div>
                <ul class="nav" role="tablist">
                    <li><a href="#welcome">Welcome</a></li>
                    <li><a href="#download">Download Roles</a></li>
                    <li><a href="#download-multiple" class="pad">Download Multiple Roles</a></li>
                    <li><a href="#download-advanced" class="pad">Advanced Downloading</a></li>
                    <li><a href="#review">Star, Watch and Count</a></li>
                    <li><a href="#share">Create and Share</a>
                        <ul class="nav">
                            <li><a href="#good" class="pad">Good Practices</a></li>
                            <li><a href="#readme" class="pad">README.md</a></li>
                            <li><a href="#meta" class="pad">Meta Data</a></li>
                            <li><a href="#tags" class="pad">Tags</a></li>
                            <li><a href="#dependencies" class="pad">Dependencies</a></li>
                            <li><a href="#variables" class="pad">Variable Names</a></li>
                            <li><a href="#role-test" class="pad">Test It</a></li>
                            <li><a href="#role-github" class="pad">Push to GitHub</a></li>
                            <li><a href="#role-galaxy" class="pad">Upload to Galaxy</a></li>
                        </ul>
                    </li>
                    <li><a href="#travis">Automated Testing</a></li>
                    <li><a href="#role-types">NEW: Role Types</a>
                        <ul class="nav">
                            <li><a href="#container-role" class="pad">Container Enabled</a></li>
                            <li><a href="#container-app" class="pad">Container App</a></li>
                        </ul>
                    </li>
                    <li><a href="#questions">Questions</a></li>
                </ul>
                <div class="back-to-top-link">
                    <a href="#"><i class="fa fa-chevron-circle-up"></i> BACK TO TOP</a>
                </div>
            </nav>
        </div>

        </div>

        <div class="col-lg-8 col-md-8">
            <div class="intro-content">
                <h2 id="welcome">Welcome to Ansible Galaxy</h2>

                <p>Ansible Galaxy is Ansible’s official community hub for sharing Ansible roles. A role is the Ansible way of bundling automation content and making it reusable.</p>
                <p>If you're not familiar with the Ansible role concept, think of include files used in a programming language. An include file allows the programmer to organize code into reusable modules.
                  Code can be organized into smaller files and grouped by subject matter or function. These discrete pieces of code can then be included as needed into larger programs like building blocks.</p>
                <p>A role is similar. Instead of creating giant playbooks with hundreds of tasks we can use roles to organize tasks, breaking them apart into smaller more discrete units of work. But a role is more than
                    just an include file. A role is all the tasks, variables and handlers needed to complete the unit of work. This allows a role to be completely self contained or encapsulated and completely reusable.</p>
                <p>Using roles also allows us to think about node configuration in terms of modeling. For example, given a set of nodes that should be web servers we can simply apply a web server role to them. We don't have
                    to think about or write all the tasks needed to configure web servers. All the details are already encapsulated in a web server role - a role you downloaded from Galaxy.</p>

                <h3 id="download">Download Roles</h3>

                <p>You can find the most popular roles and recently added roles on the <a href="/explore#/">Explore</a> page, or use <a href="/list#/roles">Browse Roles</a> to search all roles available on Galaxy.</p>
                <p>Download a role onto your Ansible host using the <strong>ansible-galaxy</strong> command that comes bundled with Ansible.</p>
                <p>For example:</p>

<pre>
$ ansible-galaxy install username.rolename
</pre>

                <h4 id="download-multiple">Download Multiple Roles</h4>

                <p>A list of roles can be specified in a file. Provide roles one per line in the format <code>username.rolename[,version]</code>.</p>
                <p>For example:</p>

<pre>
# roles.txt
user1.role1,v1.0.0
user2.role2,v0.5
user2.role3
</pre>
                <p>Install the roles:</p>
<pre>
$ ansible-galaxy install -r roles.txt
</pre>
                <h4 id="download-advanced">Advanced Downloading</h4>

                <p>Starting in Ansible 1.8 you can download roles from sources other than Galaxy, and control the install path and installed name. To use these
                    features you will need to create a Yaml file with a <code>.yml</code> extension<p>
                <p>For example:</p>
<pre>
# install_roles.yml

# from galaxy
- src: yatesr.timezone

# from github
- src: https://github.com/bennojoy/nginx

# from github installing to a relative path
- src: https://github.com/bennojoy/nginx
  path: vagrant/roles/

# from github, overriding the name and specifying a specific tag
- src: https://github.com/bennojoy/nginx
  version: master
  name: nginx_role

# from a webserver, where the role is packaged in a tar.gz
- src: https://some.webserver.example.com/files/master.tar.gz
  name: http-role

# from bitbucket, if bitbucket happens to be operational right now :)
- src: git+http://bitbucket.org/willthames/git-ansible-galaxy
  version: v1.4

# from bitbucket, alternative syntax and caveats
- src: http://bitbucket.org/willthames/hg-ansible-galaxy
  scm: hg
</pre>

                <p>Install the roles:</p>

<pre>
$ ansible-galaxy install -r install_roles.yml
</pre>

                <h3 id="review">Star, Watch and Count</h3>

                <p>There are multiple ways to gauge the goodness and popularity of a role, and you can use them all to let the community know what you think.</p>

                <p>Found a role you really like? Click the GitHub <a href="" class="btn btn-default btn-xs" disabled="disabled"><i class="fa fa-star"></i> Star</a> button. Your click increases the role's stargazer count, which appears on Galaxy and on GitHub.</p>
                <p>In addition to starring a role, you can also watch a role. Click the <a href="" class="btn btn-default btn-xs" disabled="disabled"><i class="fa fa-eye"></i> Watch</a> button to become a
                watcher and receive updates from GitHub whenever there is an update to the role. Your click increases the watchers count on Galaxy and on GitHub.</p>
                <p>We're also tracking downloads. Each time a role is downloaded and installed with the <strong>ansible-galaxy</strong> command line tool the download count on Galaxy rises. The count is limited to one per IP address. It's not a perfect measurement, but it gives you a feel for how popular a role is.</p>  

                <h3 id="share">Create and Share</h3>
                <p>Roles can be used for automating a wide variety tasks, anything from the steps in your CI/CD workflow to packaging and distributing a product your company makes. To demonstrate the process of
                    creating and sharing a role, as well as highlight some best practices to follow when creating roles, let's go through the steps to create a simple role called acme that will install the Acme web server.</p>

                <p>First, <a href="https://help.github.com/articles/create-a-repo">create a new repository on GitHub</a> called <em>ansible-role-acme</em>.  Once created, clone the repository locally:</p>

<pre>
$ git clone https://username@github.com/username/ansible-role-acme.git acme
</pre>

                <p>Next, use <strong>ansible-galaxy</strong> to create the role scaffolding:</p>

<pre>
$ ansible-galaxy init acme --force
</pre>
                <p>This creates the directory structure needed for organizing your code:<p>
<pre>
acme/
    .travis.yml
    README.md
    defaults/
    files/
    handlers/
    meta/
    tasks/
    templates/
    tests/
    vars/
 </pre>
                <p>For more about developing a role and the details behind each of the above components see
                 <a href="http://docs.ansible.com/ansible/playbooks_roles.html#roles" target="_blank">the Roles chapter</a> at the Ansible Docs site.
                </p>

                <h4 id="good">Good Practices</h4>
                <p>When developing a role there are a few practices you should always follow to help potential users discover your role and
                    make it easy for them to get started:</p>
                <ul>
                    <li>Provide clear documentation in the README.md.</li>
                    <li>Give accurate information in meta/main.yml.</li>
                    <li>Include dependencies in meta/main.yml.</li>
                    <li>Prefix variable names with the role name.</li>
                    <li>Integrate your roles with Travis CI. <a href="#travis">See how</a>.</li>
                </ul>
                <p>Sticking to these practices will help you create great roles. The community will love you, and you'll be a hero!</p>

                <h4 id="readme">README.md</h4>
                <p>The init command provides a template README.md file. Tailor it to fit by providing a
                    summary of the tasks the role performs, possible use cases, parameters and defaults, and any information users will need in
                    order to successfully run the role</p>
                <p>The file is composed in <a href="https://help.github.com/articles/markdown-basics/" target="_blank">GitHub markdown</a>.
                    Make modifications using markdown to ensure the document looks good on Galaxy and on GitHub.</p>
                <p>For example:</p>

<pre>
# README.md
# Ansible Role: Acme 2.x

An Ansible role that installs Acme 2.x on Centos 7.x

## Requirements

If you are using SSL/TLS, you will need to provide your own certificate and key files. You can generate a self-signed certificate with a command like `openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout example.key -out example.crt`.

## Role Variables

Available variables are listed below, along with default values:

    acme_listen_port: 80
    acme_listen_port_ssl: 443

## Dependencies

- username.iptables - configure the firewall and block all ports except those needed for the web server and ssh access.
- username.common - perform common server configuration

## Example Playbook

    - hosts: webservers
      roles:
        - { role: username.acme }

## License

MIT
</pre>
                <h4 id="meta">Meta Data - meta/main.yml</h4>

                <p>In <code>meta/main.yml</code> is where you provide a description, a list of supported platforms, a minimum required Ansible version,
                    a list of search tags, and any dependencies. All this information will appear on Galaxy. If it's not accurate, users may not be able to find
                    your role.</p>
                <p>Using <code>ansible-galaxy init</code> provides a template file for you to modify. It's written in <a href="http://www.yaml.org" target="_blank">YAML</a>, so be sure to follow the YAML standard as you make changes.</p>
                <p>An example for the acme role might look like the following:</p>

<pre>
---
galaxy_info:
  author: John Doe
  description: Quick and easy acme web installer.
  company: Acme
  license: MIT
  min_ansible_version: 1.9
  platforms:
  - name: EL
    versions:
    - all
  galaxy_tags:
    - acme
    - installer
    - web
dependencies:
  - { role: username.common, some_parameter: 3 }
  - { role: username.iptables, open_port: 80 }
</pre>
                <h4 id="tags">Tags</h4>
                <p>Provide any tag values you feel will help users find your role. The number of tags imported by Galaxy is limited to 20, and values containing non-alphanumeric characters will be ignored.</p>
                <p>Values containing a : will be split into multiple tags. For example, <em>cloud:ec2</em> will become two tags: <em>cloud</em> and <em>ec2</em>.</p>
                <p>The idea behind tags of course is to help users find your role, so to that end include broad terms such as <em>database</em> or <em>networking</em> as well as more specific keywords like:
                    <em>MySql</em>, <em>Cisco</em>, <em>ASR</em>, <em>TFTP</em>, etc.</p>
                <h4 id="dependencies">Dependencies</h4>
                <p>Add any roles that your role depends on. Ansible will download and execute dependencies before running your role. Specify role names by providing the Galaxy author's username and the
                    name of the role in the format <em>username.rolename</em>.</p>
                <p>For example:</p>
<pre>
dependencies:
  - { role: stouts.elasticsearch }
</pre>
                <p>Parameters can also be passed to the role:</p>
<pre>
dependencies:
  - { role: stouts.elasticsearch, elasticsearch_home: &quot;&#123;&#123; install_path_variable &#125;&#125;&quot;, elasticsearch_http_port: 8900 }
</pre>
                <p>For more on adding dependencies, see
                    <a href="http://docs.ansible.com/ansible/playbooks_roles.html#role-dependencies" target="_blank">Role Dependencies</a> on the Ansible
                    docs site.</a>.<p>

                <h4 id="variables">Variable Names</h4>
                <p>Variables are defined in <code>defaults/main.yml</code> and <code>vars/main.yml</code> Always prefix variable names with the role name. This
                    prevents variable name collision between roles. For example, use <code>acme_foo</code> rather than just <code>foo</code>

                <h4 id="role-test">Test It</h4>
                <p>The actual work to be performed gets added as playbook tasks to <em>tasks/main.yml</em>. Once you've added some tasks, create a playbook to test the role and insure it works. Here's a simple playbook
                to execute your new role:</p>
<pre>
# test.yml
# test playbook
- hosts: example
  roles:
  - { role: acme }
</pre>
<pre>
$ ansible-playbook test.yml
</pre>
                <p>Testing your role is a good practice, and to make it easier, you can automate with <a href="https://travis-ci.org" target="_blank">Travis CI</a>. See the <a href="#travis">Automated Testing with Travis CI</a> section for a guide on how to connect your role to Travis.

                <h4 id="role-galaxy">Upload to Galaxy</h4>

                <p>Once you finish development, push your changes to GitHub by running the following from within the project directory:</p>
<pre>
$ git commit -a
$ git push
</pre>

                <p>Next, log into Galaxy and click on <strong>My Roles</strong>, and you will see a list of your GitHub repositories. If you don't see the nrew repository, click the refresh button:</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/my_roles_refresh.png">
                </div>

                <p>Uploading a role is as simple as flipping a switch. Just toggle the switch to the left of the repository name so that you see a check mark, and the import process
                    will start.</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/my_roles_import.png">
                </div>

                <p>To see the status and detailed output, click the <a href="" class="btn btn-xs btn-default" disabled="disabled"><i class="fa fa-list"></i></a> button to the right of the name.</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/my_roles_details.png">
                </div>

                <p>That's all there is to it. Pretty simple. As you iterate on your role, you can trigger a new import by going to either <strong>My Roles</strong> or <strong>My Imports</strong> and
                    clicking <a href="" class="btn btn-xs btn-default" disabled="disabled"><i class="fa fa-upload"></i></a>

                <h4>Versions</h4>
                <p>If you applied any tags to your repository, Galaxy will automatically display a “version” for each tag.  This means users can choose the version (tag) to download.</p>

                <p>The default behavior, if there are no tags, is to make the “HEAD” version available. This means users downloading the role will always get the latest from the github repository.</p>

                <p>To import new tags, trigger a new import by visiting either <strong>My Roles</strong> or <strong>My Imports</strong> and clicking <a href="" class="btn btn-xs btn-default" disabled="disabled"><i class="fa fa-upload"></i></a></p>

                <h3 id="travis">Automated Testing</h3>

                <p>Testing your roles is a great practice. Automated testing is even better, and we've made it easy for you to add <a href="http://travis-ci.org" target="_blank">Travis CI</a> to your roles.</p>

                <p>Add your <a href="https://blog.travis-ci.com/2013-01-28-token-token-token/" target="_blank">Travis token</a> to any role you want to integrate. Your token is not stored in Galaxy. It is used to calculate a hash as described in <a href="https://docs.travis-ci.com/user/notifications/#Authorization-for-Webhooks" target="_blank">the Travis documentation</a> and then discarded.</p>

                <p>Add the token on <strong>My Roles</strong>:</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/add-token.png">
                </div>

                <p>Enable the repo on your Travis profile page:</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/enable-in-travis.png">
                </div>

                <p>Add a .travis.yml file to your repo that includes a notifications section with webhooks pointed to the galaxy server as pictured below:</p>
<pre>
notifications:
    webhooks: https://galaxy.ansible.com/api/v1/notifications/
</pre>

                <div class="alert alert-info">
                    <p><strong>NOTE:</strong> For a full .travis.yml example run <code>ansible-galaxy init</code>. Starting in Ansible 2.0 the generated scaffolding includes a working .travis.yml file and related tests folder.</p>
                </div>

                <p>Push the changes to your GitHub repo. This will kick-off a Travis build. When the build completes, Travis will notify Galaxy, and your role will be automatically imported into Galaxy with a Travis badge:</p>

                <div class="screen-shot">
                    <img src="/static/img/intro/travis-integrated.png">
                </div>

                <h4 id="specify-branch">Specify a Branch</h4>
                Notifications from Travis will be accepted for the GitHub repo's default branch (usually master). If you want to set a specific branch that notifications will be accepted from, define <code>github_branch</code> in meta/main.yml:
<pre>
galaxy_info:
    galaxy_info:
    author: Me
    description: Testing role imports.
    ...

    github_branch: release
    
    ...
</pre>
                <h3 id="role-types">NEW: Role Types</h3>
                <p>With the role out of Galaxy 2.1.0 we introduced two new role types that work in conjunction with <a href="https://github.com/ansible/ansible-container" target="_blank">Ansible Container</a> to
                        bring the power of Ansible and Ansible Roles to managing and distributing container applications.</p>

                <h4 id="container-role">Container Enabled</h4>
                <p>Container enabled roles provide building blocks for Ansible Container projects. A project typically defines multiple services that work together to form an application. For example, a project
                        might include a web server and a database service. Rather than starting from scratch to define each of these services, now you can simply download a container role that does it for you. Install
                        the role into your project, and adjust it to fit your needs.</p>
                 <p>It's similar to pulling a Docker image, but better! When you install the role, it updates your orchestration document <code>container.yml</code> with settings and defaults, and adds any build
                        tasks to your <code>main.yml</code>. No more lost time sifting through the README or the Dockerfile. Just install it, and the work is done for you. Want to see how the service works or change
                        settings? No problem. Open your <code>contianer.yml</code>, and everything you need is there.</p>

                 <p>The role contains a service definition in <code>meta/container.yml</code>, along with defaults for the service's container settings in <code>defaults/main.yml</code>, and a list of tasks for
                        building the service's image in <code>tasks/main.yml</code>. It's everything needed to build an image and launch a container. All you have to do is run
                        <code>ansible-container install</code> to plug it into your project.

                 <p>When the role is installed, the following tasks are performed by Ansible Container:<p>

                 <ul>
                     <li><code>meta/container.yml</code> will be added to <code>ansible/container.yml</code> along with any defaults found in <code>defaults/main.yml</code></li>
                     <li>a new play will be added to <code>ansible/main.yml</code> with <em>hosts</em> set to the service name</li>
                        <li>any tasks defined in <code>tasks/main.yml</code> will be added to the play</li>
                 </ul>

                 <h4 id="container-app">Container App</h4>

                 <p>A Container App is designed to distribute a complete applications that's been defined in Ansible Container. It contains one or more services ready to run. Just download and go. Use it as
                    defined, or use it as the starting point for a new project. Either way, it has everything you need to be up and running in moments.</p>

                 <p>The role contains a complete Ansible Container project. Everything needed to launch the application from the <code>ansible</code> directory to application sourcecode is included. Download
                    it by running the <code>ansible-container init</code> command.</p>

                 <p>For example:</p>
    <pre>
    $ mkdir example
    $ cd example
    $ ansible-container init &lt;role name&gt;
    $ ansible-container build
    $ ansible-container run
    </pre>
                 <p>That's it! With a Conatainer App it's now easier than ever to distribute applications, jump-start projects, and get work done. We can't wait to see what you create!</p>

                 <p>For more information about Ansible Container, visit the <a href="https://github.com/ansible/ansible-container" target="_blank">project repo</a>, or check out the
                        <a href="https://docs.ansible.com/ansible-container" target="_blank">doc site</a>.</p>

                <h3 id="questions">Questions?</h3>

                <p>If you have unanswered Galaxy questions, feel free to ask on the <a href="https://groups.google.com/forum/#!forum/ansible-project" target="_blank">Ansible mailing list</a>. Found a bug or have  a suggestion? Let us know at <a href="https://github.com/ansible/galaxy-issues" target="_blank">Galaxy Issues</a>.</p>
                <div class="alert alert-info">
                    <p><strong>NOTE:</strong> Contents, usage and bugs related to specific roles will not be supported on the mailing list. Contact the role author via GitHub. The role details provided in Galaxy include a link to the GitHub repository, and when available, the issue tracker.</p>
                </div>
            </div><!-- intro-content -->
        </div><!-- col-lg-9 -->
    </div><!-- row -->
</div>
{% endblock %}
